import{a as Q,b as M,t as ne,u as ae,c as oe,l as ce}from"./vendors--AiD9Gvs.js";import{a as w,g as C,e as I,f as E,r as l,h as ue,i as le,u as V}from"./vendor_react-DLFB9-kf.js";import{_ as ie}from"./vendor_lodash-CD85c6SO.js";class fe{constructor(e){this.syncCallbacks=[],this.asyncCallbacks=[],this.name=e||""}register(e,r){r?this.syncCallbacks.push({priority:r,callback:e}):this.asyncCallbacks.push(e)}async execute(){const e=this.syncCallbacks.sort((r,s)=>r.priority-s.priority).map(r=>r.callback);for(const r of e)try{await r()}catch(s){console.error(this.name+"Callback execution error:",s)}this.asyncCallbacks.forEach(async r=>{try{await r()}catch(s){console.error(this.name+"Callback execution error:",s)}})}}const P={},b={},S={on:(t,...e)=>{var n;const[r,...s]=e;P[t]||(P[t]=new fe(t)),(n=P[t])==null||n.register(r,...s),b[t]&&r()},exec:async t=>{var r;if(b[t])return;const e=status==="success";switch(b[t]=e,t){case"exit":b.start=e;break;case"start":b.exit=e;break;case"login":b.logout=e;break;case"logout":b.login=e;break}switch(await((r=P[t])==null?void 0:r.execute()),t){case"changeLocale":b.changeLocale=!1;break;case"changeTheme":b.changeTheme=!1;break;case"login":b.logout=!1;break;case"logout":b.login=!1;break;case"exit":b.start=!1;break;case"start":b.exit=!1}}},tt=Object.freeze(Object.defineProperty({__proto__:null,default:S},Symbol.toStringTag,{value:"Module"}));function de(){return!1}const j={get isDevMode(){return de()}},rt=Object.freeze(Object.defineProperty({__proto__:null,commonConstant:j},Symbol.toStringTag,{value:"Module"}));function ge(t,e){const r=w(!1);let s=e;const n=w(a=>(a(r),s),async(a,c)=>{s=await t(a),c(r,u=>!u)});return e||(n.onMount=a=>{a()}),n}function he(t,e){const r=w(!1),s=w("loading"),n=w(void 0);let a=e;const c=w(u=>(u(r),{data:a,status:u(s)}),async(u,o)=>{o(n,void 0),o(s,"loading");try{a=await t(u),o(s,"success"),o(r,f=>!f)}catch(f){throw o(s,"error"),o(n,f),f}});return e||(c.onMount=u=>{u()}),c}const me=t=>new Promise(e=>setTimeout(e,t)),T=t=>{const r=`atom:3793cc:${t}`;return j.isDevMode?r:btoa(r)};function ye(t){if(j.isDevMode)return JSON.stringify(t);try{return btoa(encodeURIComponent(JSON.stringify(t)))}catch(e){return console.error(e),JSON.stringify(t)}}function be(t){if(j.isDevMode)return JSON.parse(t);try{return JSON.parse(decodeURIComponent(atob(t)))}catch(e){return console.error(e),JSON.parse(t)}}function W(t=localStorage){const e=t;return{getItem(s,n){const a=e.getItem(s);if(a)try{return be(a)}catch(c){return console.error(c),n}return n},setItem(s,n){if(n==null)return this.removeItem(s);const a=ye(n);e.setItem(s,a)},removeItem(s){e.removeItem(s)}}}const st=Object.freeze(Object.defineProperty({__proto__:null,atomWithRefreshWithoutSuspense:ge,atomWithRefreshWithoutSuspenseLoadable:he,createSyncStorage:W,generateAtomStorageKey:T,wait:me},Symbol.toStringTag,{value:"Module"})),pe=T("config_lang");let F="en-US";const U=C(),L=I(pe,F);function q(){return U.get(L)}function _e(t){F=t}function we(t){const e=U.get(L);t!==e&&(U.set(L,t),S.exec("changeLocale"))}class X{constructor(e){this.t=(r,s,n)=>{var c,u,o;const a=((c=this.currentBook(n))==null?void 0:c[r])??((u=this.currentBook(F))==null?void 0:u[r])??((o=this.currentBook("en-US"))==null?void 0:o[r])??r;return this.replaceVariables(a,s)},this.currentBook=r=>(r||(r=q()),this.mapper[r]),this.replaceVariables=(r,s)=>s?r.replace(/\{(\w+)\}/g,(n,a)=>s[a]??`{${a}}`):r,this.mapper=e}}function B(){return E(L)}function Se(t){const e=B();return l.useMemo(()=>({currentBook:t.currentBook(e),t:(n,a)=>t.t(n,a,e)}),[e,t])}const nt=Object.freeze(Object.defineProperty({__proto__:null,LangBook:X,getLocale:q,setDefaultLocale:_e,setLocale:we,useLangBook:Se,useLocale:B},Symbol.toStringTag,{value:"Module"}));let z;function v(t,e){if(z)return z(t,e);console.error("Toast instance does not exist")}const ke={toast(t){z=t}},at=Object.freeze(Object.defineProperty({__proto__:null,init:ke,toast:v},Symbol.toStringTag,{value:"Module"})),Z={baseURL:"/",headerAuthKey:"Authorization",headerAuthPrefix:"Bearer",headerLocaleKey:"Locale",tokenGetter:async()=>{},timeout:5e3,authRequiredCallers:[]};let p=Z;const Me=new Set;function Oe(t){p={...Z,...t},ee=Q.create({baseURL:p.baseURL,timeout:p.timeout}),p.authRequiredCallers;for(const e of p.authRequiredCallers)Me.add(e)}let ee=Q.create({baseURL:p.baseURL,timeout:p.timeout});function ve(t=3){const r=new Error().stack.split(`
`)[t].trim(),s=r.match(/at (.+) \(/);return s?s[1]:r}const je=async t=>{var y,i;const e=ve();j.isDevMode&&console.log(`request: %c${e}`,"color: #FF0");const{ignoreAuth:r,throwError:s,pathVariables:n,...a}=t;let{silentError:c,headers:u,url:o}=t;if(u={...u,[p.headerLocaleKey]:q()},!r){const g=await p.tokenGetter();if(g)u={...u,[p.headerAuthKey]:`${p.headerAuthPrefix} ${g}`};else throw new Error("token is required")}if(n){const g=n;o=o.replace(/{(\w+)}/g,(d,m)=>{const k=g[m];return k!==void 0?k.toString():d})}const f={...a,headers:u,url:o};try{return(await ee.request(f)).data}catch(g){const h=g;let d;if(h.code==="ECONNABORTED")d={success:!1,errorCode:102,errorMessage:x("timeout")};else if(h.response)if(h.response.data.success!==void 0)switch(d=h.response.data,h.response.status){case 401:{h.response.data.errorMessage==="token is required"&&(c=!0),h.response.data.errorCode===31e7&&(c=!0),await S.exec("logout"),c=!0;break}case 404:if(h.response.data.errorCode===1e8&&h.response.data.errorMessage==="data not found"&&h.response.data.success===!1){c=!0;break}}else d={success:!1,errorCode:100,errorMessage:x("unknown")};else d={success:!1,errorCode:101,errorMessage:x("network")};if(!c&&d.errorMessage)if(typeof window>"u"){const m=g;console.info(`URL: ${(y=m.config)==null?void 0:y.baseURL}${(i=m.config)==null?void 0:i.url}
${d.errorMessage}`)}else v==null||v(d.errorMessage,{level:"error"});if(s)throw d;return d}},{t:x}=new X({"en-US":{network:"Request failed, please check your network",unknown:"Unknown error.",timeout:"Request timed out."},"zh-CN":{network:"请求失败，请检查网络",unknown:"未知错误",timeout:"请求超时"}}),ot=Object.freeze(Object.defineProperty({__proto__:null,default:je,init:Oe},Symbol.toStringTag,{value:"Module"}));let A;function Pe(t){A=t.getUploadLinkService}const Ae={progress:0,loading:!1};function Le({accept:t="*"}={}){const[e,r]=l.useState(Ae),s=l.useRef(!1),n=l.useRef(),{choose:a,chooseAndUpload:c,upload:u}=l.useMemo(()=>{const o=async()=>{if(A===void 0){console.error("get upload link method not fond");return}if(s.current){console.error("uploading");return}const i=await new Promise((g,h)=>{const d=document.createElement("input");d.type="file",d.accept=t,d.onchange=m=>{var K;const O=(K=m.target.files)==null?void 0:K[0];g(O),d.remove()},d.click()});if(i){const g=await new Promise((h,d)=>{const m=new FileReader;m.readAsDataURL(i),m.onload=k=>{var O;h((O=k.target)==null?void 0:O.result)}});n.current=i,r(h=>({...h,file:i,previewUrl:g}))}return i},f=async()=>{if(A===void 0){console.error("get upload link method not fond");return}if(s.current)return;const i=n.current;if(!i){console.error("No file chosen");return}const g={filename:i.name,fileContentType:i.type,contentLength:i.size};s.current=!0,r(d=>({...d,loading:!0}));const h=await A(g);if(!h){r(d=>({...d,loading:!1,progress:0,successful:!1})),s.current=!1,console.error("get upload link failed");return}try{const d=await Q(h.uploadUrl,{method:"PUT",data:i,headers:{"Content-Type":h.header.contentType},onUploadProgress:m=>{const k=Math.round(m.loaded*100/(m.total??0));r(O=>({...O,loading:!0,progress:k}))}});if(s.current=!1,d.status<300)return r(m=>({...m,loading:!1,progress:0,successful:!0})),h.visitUrl;r(m=>({...m,loading:!1,progress:0,successful:!1})),v("File upload failed",{level:"error"})}catch{r(m=>({...m,loading:!1,progress:0,successful:!1})),s.current=!1,v("File upload failed",{level:"error"})}};return{chooseAndUpload:async()=>{try{const i=await o();return await f()}catch(i){console.error(i)}},choose:o,upload:f}},[t]);return{chooseAndUpload:c,upload:u,choose:a,...e}}const ct=Object.freeze(Object.defineProperty({__proto__:null,init:Pe,useUpload:Le},Symbol.toStringTag,{value:"Module"}));async function $e(t,e,r){const s=await e({name:t.filename,contentType:t.fileContentType,size:t.contentLength});if(s.success){const n=r(s);return{...s,data:n}}return{success:!1,errorMessage:"Failed to get upload link",errorCode:500}}const ut=Object.freeze(Object.defineProperty({__proto__:null,getUploadRequest:$e},Symbol.toStringTag,{value:"Module"}));function Ce(t,e,r){const[s,n]=l.useState(e);return l.useEffect(()=>{t().then(n)},r??[]),s}function Te(t){const[e,r]=l.useState(t);return l.useEffect(()=>{r(t)},[t]),[e,r]}function xe(t,e){const[r,s]=l.useState(()=>{if(typeof window>"u")return e;const n=window.localStorage.getItem(t);return n?JSON.parse(n):e});return l.useEffect(()=>{window.localStorage.setItem(t,JSON.stringify(r))},[t,r]),[r,s]}function Re(t,e){const[r,s]=l.useState(t);return l.useEffect(()=>{e(r)},[e,r]),[t,s]}function De(t,e){const[r,s]=l.useState({loading:!1,params:e==null?void 0:e.initialParams}),n=l.useRef(!1),a=async(...c)=>{var o;if(n.current)return;n.current=!0,s(f=>({...f,params:c,loading:!0}));const u=c?await t(...c):await t();return n.current=!1,s({params:c,loading:!1,result:u}),(o=e==null?void 0:e.onRan)==null||o.call(e,u),u};return l.useEffect(()=>{e!=null&&e.manual||a(e==null?void 0:e.initialParams)},[]),{...r,run:a}}function Y(t){return t?Object.fromEntries(Object.entries(t.valueOf())):{}}function Ee(t,e=!1){const[r,s]=ue(),n=Object.fromEntries(r.entries()),a=l.useMemo(()=>t&&Y(t),[t]),c=l.useCallback((...u)=>{const o=u;if(typeof u[0]=="function"){const f=u[0],y=i=>{const g=f(i);return e?{...a,...g}:{...a,...a,...g}};o[0]=y}if(typeof u[0]=="object"){const f=Y(u[0]);e&&(o[0]={...a,...f}),o[0]={...n,...a,...f}}s(...o)},[s,t,n,e]);return[r,c]}const lt=Object.freeze(Object.defineProperty({__proto__:null,useAppendableSearchParams:Ee,useAsyncMemo:Ce,useLocalStorage:xe,useQueryApi:De,useStateConnect:Re,useStateEffectedBy:Te},Symbol.toStringTag,{value:"Module"}));function Ue(t,e=[]){const[r,s]=l.useState(!1),n=l.useRef(!1);return[l.useCallback(async(...c)=>{if(n.current)return;n.current=!0,s(!0);const u=await t(...c);return n.current=!1,s(!1),u},e),r]}const it=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}));M.extend(ne);M.extend(ae);M.extend(oe);M.extend(ce);M.tz.setDefault("Asia/Manila");M.updateLocale("en-us",{weekStart:1});const J=M;function te(t,e){const r=J(t);switch(e){case"date":return r.format("YYYY-MM-DD");case"time":return r.format("HH:mm");case"datetime":default:return r.format("YYYY-MM-DD HH:mm")}}const ft=Object.freeze(Object.defineProperty({__proto__:null,dayjsManila:J,formatDate:te},Symbol.toStringTag,{value:"Module"})),ze={loading:!1},_=C(),R=new Map,Ne=le(t=>(R.has(t)||R.set(t,w(!1)),R.get(t)));let Qe=0;function re(t,e=!1){var f,y;const r=T(`createGlobalApiData-${((f=t.displayName)==null?void 0:f.trim())||((y=t.name)==null?void 0:y.trim())||Qe++}`);function s(...i){j.isDevMode&&console.log(`${r}`,...i)}const n=Ne(r),a=I(r,ze,W(),{getOnInit:!0});async function c(){_.set(n,!0),_.set(a,i=>({...i,loading:!0}));try{const i=await t();if(i.success)_.set(a,{data:i.data,loading:!1}),s("reloaded");else throw new Error(i.errorMessage)}catch{_.set(n,!1),_.set(a,g=>({...g,loading:!1}))}}const u=ie.debounce(c,3e3,{leading:!0,trailing:!1});u.displayName=`reload-${r}`;function o(){const i=E(n),g=E(a);return l.useEffect(()=>{i||u()},[i]),{...g,reload:u}}return e&&(S.on("login",u,1),S.on("logout",async function(){_.set(n,!1),_.set(a,{loading:!1})})),S.on("start",u,1),[o,a,u,(...i)=>{_.set(a,...i)}]}const dt=Object.freeze(Object.defineProperty({__proto__:null,createGlobalApiData:re},Symbol.toStringTag,{value:"Module"}));function se(t,e){const[r,s]=l.useState({loading:!1,params:e==null?void 0:e.initialParams}),n=l.useRef(!1),a=async(...c)=>{var o;if(n.current)return;n.current=!0,s(f=>({...f,params:c,loading:!0}));const u=c?await t(...c):await t();return n.current=!1,s({params:c,loading:!1,result:u}),(o=e==null?void 0:e.onRan)==null||o.call(e,u),u};return l.useEffect(()=>{e!=null&&e.manual||a(...(e==null?void 0:e.initialParams)??[])},[]),{...r,run:a}}const gt=Object.freeze(Object.defineProperty({__proto__:null,useQueryApi:se},Symbol.toStringTag,{value:"Module"}));function Ie(t){const e=l.useRef(Date.now()),[r,s]=l.useState(Date.now()),n=l.useRef(!1),a=l.useMemo(()=>J(r).diff(e.current,"second"),[r]),c=l.useMemo(()=>t.secondsEnd-a,[a]);l.useEffect(()=>{const o=setInterval(()=>{s(Date.now())},200);return()=>{clearInterval(o)}},[]),l.useEffect(()=>{var o;c<0&&!n.current&&(n.current=!0,(o=t.callback)==null||o.call(t))},[c,t.callback]);const u=l.useMemo(()=>c<0?0:c,[c]);return{secondsCountDown:c,secondsCountDownDisplay:u}}const ht=Object.freeze(Object.defineProperty({__proto__:null,createGlobalApiData:re,useCountDownSeconds:Ie,useQueryApi:se},Symbol.toStringTag,{value:"Module"}));class ${constructor(...e){this.l=r=>{var s;return((s=this.map[r])==null?void 0:s.label)??r},this.items=e,this.map=Fe(...e)}}function Fe(...t){const e={};return t.forEach(r=>e[r.value]=r),e}function qe(t){const e=w({}),r=C();let s;async function n(c){if(s===c)return;s=c;const u={};try{const o=await t(c);if(!o.success)throw new Error(o.errorMessage);Object.entries(o.data).forEach(([f,y])=>{u[f]=new $(...y)})}catch{s=void 0}r.set(e,u)}function a(c){const u=B();l.useEffect(()=>{n(u)},[u]);const[o]=V(e);return o[c]?o[c]:new $}return a}function Be(t,e,r,s){return l.useMemo(()=>t?new $(...t.map(a=>{const c={value:e(a),label:r(a)};return s&&(c.tip=s(a)),c})):void 0,[t])}const mt=Object.freeze(Object.defineProperty({__proto__:null,Dict:$,defineDictHook:qe,useDictFromList:Be},Symbol.toStringTag,{value:"Module"}));function Je(t=0,e){const{round:r=2,interval:s=3,separator:n=","}=e||{};let a=typeof t=="string"?parseFloat(t):t;isNaN(a)&&(a=0),a=parseFloat(a.toFixed(r));let[c,u]=a.toString().split(".");const o=new RegExp(`\\B(?=(\\d{${s}})+(?!\\d))`,"g");return c=c.replace(o,n),u?`${c}.${u}`:c}function Ke(t){return t?t.replace(/(\d{3})\d{4}(\d{2,})/,"$1****$2"):""}function Ye(t){if(!t)return"";const[e,r]=t.split("@");if(!e||!r)return"";const s=e.length>2?`${e[0]}${"*".repeat(e.length-2)}${e[e.length-1]}`:e[0]+"*",n=r.split("."),a=n.length>1?`${n[0][0]}${"*".repeat(n[0].length-2)}${n[0][n[0].length-1]}.${n.slice(1).join(".")}`:r;return`${s}@${a}`}const yt=Object.freeze(Object.defineProperty({__proto__:null,formatAmount:Je,formatDate:te,maskEmail:Ye,maskPhoneNumber:Ke},Symbol.toStringTag,{value:"Module"})),bt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),pt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),He=T("config_theme"),N={},H=C(),D=I(He,N);function Ge(){const[t,e]=V(D);return[t,n=>{const a=Object.assign({},t,n);H.set(D,a),e(a),S.exec("changeTheme")},()=>{H.set(D,N),e(N),S.exec("changeTheme")}]}const _t=Object.freeze(Object.defineProperty({__proto__:null,useTheme:Ge},Symbol.toStringTag,{value:"Module"}));class Ve{constructor(){this.readers=0,this.writer=!1,this.readQueue=[],this.writeQueue=[]}async readLock(){return new Promise(e=>{this.writer||this.writeQueue.length>0?this.readQueue.push(e):(this.readers++,e())})}async readUnlock(){this.readers--,this.processQueues()}async writeLock(){return new Promise(e=>{this.writer||this.readers>0?this.writeQueue.push(e):(this.writer=!0,e())})}async writeUnlock(){this.writer=!1,this.processQueues()}processQueues(){if(!this.writer&&this.writeQueue.length>0){this.writer=!0;const e=this.writeQueue.shift();e&&e()}else if(!this.writer&&this.readers===0&&this.readQueue.length>0)for(;this.readQueue.length>0;){const e=this.readQueue.shift();e&&e(),this.readers++}}}const wt=Object.freeze(Object.defineProperty({__proto__:null,Locker:Ve},Symbol.toStringTag,{value:"Module"})),G={hasMore:!1,loading:!1};function We(t,e){const[r,s]=l.useState(!1),n=l.useRef(G),a=l.useMemo(()=>({loadMore:async()=>{var h,d,m;let o=n.current;if(o.args===void 0){console.warn("never load");return}if(o.loading){console.warn("loading");return}if(!o.hasMore){console.warn("no more");return}const f=(h=o.data)==null?void 0:h.nextCursor;if(!f){console.warn("no next cursor");return}n.current.loading=!0,s(!0);const y=[...o.args];y[0]={...y[0],startCursor:f};const i=((d=o.data)==null?void 0:d.list)??[],g=await t(...y);o={...o,loading:!1},g.success&&(o.hasMore=g.data.nextCursor!==void 0,o.data={...g.data,list:[...i,...((m=g.data)==null?void 0:m.list)??[]]},o.args=y),n.current=o,s(!1)},reload:async(...o)=>{if(n.current.loading)return;let f={...G,loading:!0,args:o};n.current=f,s(!0);const y=await t(...o);f={...f,loading:!1},y.success&&(f.hasMore=y.data.nextCursor!==void 0,f.data=y.data),n.current=f,s(!1)}}),[t]);l.useEffect(()=>{e&&a.reload(...e.args)},e!=null&&e.depends?e==null?void 0:e.depends:[]);const{data:c,hasMore:u}=n.current;return{data:c,hasMore:u,loading:r,...a}}const St=Object.freeze(Object.defineProperty({__proto__:null,useCursorQueryApi:We},Symbol.toStringTag,{value:"Module"}));export{at as A,ot as B,ct as C,$ as D,ut as E,lt as F,it as G,ft as H,dt as I,gt as J,ht as K,X as L,mt as M,yt as N,bt as O,pt as P,_t as Q,wt as R,St as S,ge as a,Ce as b,S as c,W as d,j as e,$e as f,T as g,re as h,J as i,B as j,Ie as k,se as l,Je as m,Se as n,Oe as o,Pe as p,ke as q,je as r,Ee as s,v as t,Ue as u,tt as v,me as w,rt as x,st as y,nt as z};
