import{b as k}from"../core-z1JMQ5Ff.js";import{x as E,C as x}from"../vendor_react-DLFB9-kf.js";import{F as l,a as I,b as u,c as p,d as b,e as y,f,g as h,h as F,i as C,j as T,k as P,l as g,m as w,n as B,o as q,p as O,q as A,r as M}from"./components/formItem/index-ClhLfjw4.js";import{a}from"../enum-Cky0aGNf.js";import{U as S}from"../api_interface-Cuputjbr.js";import{W as V,_ as K}from"../features-CK6znDLX.js";const j=E,G=x;function R(r){var c;const e=j(),t=e.watch(r);return k(async()=>{var s;try{return await e.trigger(r),(s=e.getFieldState(r))==null?void 0:s.error}catch(d){console.error(d);return}},(c=e.getFieldState(r))==null?void 0:c.error,[t,r])}const H={[a.KycOcrSelectIdType]:{requiredPath:["basic.idType"],requiredComponents:[l]},[a.KycOrcInformationConfrim]:{requiredPath:["basic.idType","medias.idPhoto.url","medias.face.url","basic.realName.firstName","basic.realName.middleName","basic.realName.lastName","basic.birthday","more.phoneNumber","more.nationality","more.placeOfBirth","more.currentAddress","more.permanentAddress","more.nearestBranch","more.occupation","more.sourceOfIncome"],requiredComponentsSections:[{sectionName:"Basic",sectionTitle:"Basic Information",components:[I,u,p,b,y,f,h,F,C]},{sectionName:"Address",sectionTitle:"Address Information",components:[T,P,g,w,B]},{sectionName:"Income",sectionTitle:"Income Information",components:[q,O]}]},[a.BasicVerifyFormSelectIdType]:{requiredPath:["basic.idType"],requiredComponents:[l]},[a.CompleteVerifyFormSelectIdType]:{requiredPath:["basic.idType"],requiredComponents:[l]},[a.BasicVerifyFormFillInBasicInformation]:{requiredPath:["basic.idNumber","basic.realName.firstName","basic.realName.middleName","basic.realName.lastName","basic.birthday","basic.gender","more.phoneNumber"],requiredComponents:[A,b,y,f,h,C]},[a.BasicVerifyFormUploadIdPhoto]:{requiredPath:["basic.idType","basic.realName.firstName","basic.realName.middleName","basic.realName.lastName","basic.birthday","more.phoneNumber","medias.idPhoto","medias.face","medias.selfieWithIDPhotoPath"],requiredComponents:[u,p]},[a.CompleteVerifyForm]:{requiredPath:["basic.idType","medias.face","medias.idPhoto","basic.realName.firstName","basic.realName.middleName","basic.realName.lastName","basic.birthday","basic.gender","more.nationality","more.placeOfBirth","more.currentAddress","more.permanentAddress","more.nearestBranch","more.occupation","more.sourceOfIncome"],requiredComponents:[I,A,u,p,b,y,f,h,F,T,P,g,w,B,q,M,O]}};async function J(r,e){try{const t=await(async()=>{const d=Object.entries((e==null?void 0:e.medias)??{}).map(async([N,m])=>{try{if(m.url&&!/data:image\/[a-z]{3,5};base64/g.test(m.url)&&!(m.file instanceof File))return[N,m.url];const o=m.file;if(!o)throw new Error("No file");const i=await V({filename:o.name,fileContentType:o.type,contentLength:o.size},"kyc_media");if(!i.data)throw new Error("get upload link failed");return await K({uploadUrl:i.data.uploadUrl,file:o,headers:i.data.header}),[N,i.data.visitUrl]}catch(o){return console.error(o.message),[]}}),U=await Promise.all(d);return Object.fromEntries(U)})(),n={realName:e.basic.realName,birthday:e.basic.birthday,phoneNumber:e.more.phoneNumber,nearestBranch:e.more.nearestBranch,idType:e.basic.idType,idNumber:e.basic.idNumber,gender:e.basic.gender??"un_know",placeOfBirth:e.more.placeOfBirth,nationality:e.more.nationality,currentAddress:e.more.currentAddress,permanentAddress:e.more.permanentAddress,sourceOfIncome:e.more.sourceOfIncome,occupation:e.more.occupation,attachments:t},s=await(()=>{switch(r){case"basic":return S.bind(null,n);case"full":default:return S.bind(null,n)}})()();if(s.success)return s;throw new Error(s.errorMessage)}catch(t){throw console.error(t),t}}async function Q(r){console.error(r)}export{G as C,j as a,Q as b,H as k,J as s,R as u};
